<html>
    <head>
        <link rel="import" href="libraries.html">
        <link rel="import" href="htk-component.html">
    </head>
    <body>
        <template id="tswitch">
            <htk-library-editor id="tlibrary-editor"></htk-library-editor>
            <!--Export in inkscape with viewBox and with optimised svg!-->
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
            <!-- Created with Inkscape (http://www.inkscape.org/) -->
            <svg xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 383 43" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/"">
             <metadata id="metadata7">
              <rdf:RDF>
               <cc:Work rdf:about="">
                <dc:format>image/svg+xml</dc:format>
                <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>
                <dc:title/>
               </cc:Work>
              </rdf:RDF>
             </metadata>
             <g id="layer1" stroke-linejoin="miter" stroke-dashoffset="0" transform="translate(-108.5,-40.875)" stroke="#000" stroke-linecap="butt" stroke-miterlimit="4" stroke-dasharray="none">
              <rect id="rect2987" style="enable-background:accumulate;color:#000000;" rx="30" ry="0" height="40" width="380" y="42.362" x="110" stroke-width="3" fill="#c8c8c8"/>
              <rect id="rect3759" style="enable-background:accumulate;color:#000000;" rx="0" height="20" width="20" y="52.362" x="120" stroke-width="1.3333" fill="#F00"/>
              <rect id="rect3759-1" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="150" stroke-width="0.66667" fill="#FF0"/>
              <rect id="rect3797" style="enable-background:accumulate;color:#000000;" height="20" width="30" y="52.362" x="170" stroke-width="3" fill="#666"/>
              <rect id="rect3759-1-7" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="170" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3759-1-7-4" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="190" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3797-0" style="enable-background:accumulate;color:#000000;" height="20" width="30" y="52.362" x="210" stroke-width="3" fill="#666"/>
              <rect id="rect3759-1-7-9" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="210" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3759-1-7-4-4" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="230" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3797-8" style="enable-background:accumulate;color:#000000;" height="20" width="30" y="52.362" x="250" stroke-width="3" fill="#666"/>
              <rect id="rect3759-1-7-8" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="250" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3759-1-7-4-2" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="270" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3797-0-4" style="enable-background:accumulate;color:#000000;" height="20" width="30" y="52.362" x="290" stroke-width="3" fill="#666"/>
              <rect id="rect3759-1-7-9-5" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="290" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3759-1-7-4-4-5" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="310" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3797-8-1" style="enable-background:accumulate;color:#000000;" height="20" width="30" y="52.362" x="330" stroke-width="3" fill="#666"/>
              <rect id="rect3759-1-7-8-7" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="330" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3759-1-7-4-2-1" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="350" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3797-0-4-1" style="enable-background:accumulate;color:#000000;" height="20" width="30" y="52.362" x="370" stroke-width="3" fill="#666"/>
              <rect id="rect3759-1-7-9-5-5" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="370" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3759-1-7-4-4-5-2" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="390" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3797-8-1-7" style="enable-background:accumulate;color:#000000;" height="20" width="30" y="52.362" x="410" stroke-width="3" fill="#666"/>
              <rect id="rect3759-1-7-8-7-6" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="410" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3759-1-7-4-2-1-1" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="430" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3797-0-4-1-4" style="enable-background:accumulate;color:#000000;" height="20" width="30" y="52.362" x="450" stroke-width="3" fill="#666"/>
              <rect id="rect3759-1-7-9-5-5-2" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="450" stroke-width="0.66667" fill="#0F0"/>
              <rect id="rect3759-1-7-4-4-5-2-3" style="enable-background:accumulate;color:#000000;" rx="0" height="10" width="10" y="52.362" x="470" stroke-width="0.66667" fill="#0F0"/>
             </g>
             <g id="layerChanges1">
                <rect x="0" y="0" width="50%" height="100%" fill="0xffffffff"/>
             </g>
             <g id="layerChanges2">
                <rect x="50%" y="0" width="50%" height="100%" fill="0xffffffff"/>
            </svg>
        </template>
        <script>
            (function () {
                var importDoc = document.currentScript.ownerDocument; // importee

                class HtkSwitch extends HtkLibrary {

                    cubicleUnitsToPixels(units) {
                        return CU_UNITS_TO_INCHES * INCHES_TO_PX * units;
                    } 

                    inchesToPixels(inches) {
                        return INCHES_TO_PX * inches;
                    } 

                    // Use Shadow DOM and a template.
                    createdCallback () {
                        super.createdCallback();
                        this.svg = this.shadowRoot.querySelector("svg");
                        this.svg.setAttribute("width", this.inchesToPixels(19));
                        this.svg.setAttribute("height", this.cubicleUnitsToPixels(1));
                        var cuLocation = parseInt(this.getAttribute("data-location-cubicle"));
                        this.svg.setAttribute("y", this.cubicleUnitsToPixels(cuLocation));
                        this.attachLibraryHandler();
                        this.layerChanges1 = this.shadowRoot.querySelector("#layerChanges1");
                        this.layerChanges1.setAttribute("opacity", "0");
                        this.layerChanges2 = this.shadowRoot.querySelector("#layerChanges2");
                        this.layerChanges2.setAttribute("opacity", "0");
                    }

                    attachedCallback () {
                        this.svg.addEventListener("click", function(e) {
                            this.showLibraryEditor();
                        }.bind(this));
                    }

                    getTemplate() {
                        var template = importDoc.querySelector("#tswitch");
                        return template;
                    }

                    libraryChanged (libraryOwner, newLibraryName) {
                        this.value = libraryOwner + "/" + newLibraryName;
                        this.checkValues();
                    }

                    checkValues () {
                        //If the current value does not match the initial value set the font color blue
                        if(!this.compareValues(this.getValue(), this.getInitialValue())) {
                            this.layerChanges1.setAttribute("fill", DIFF_INIT_CHANGED_COLOR);
                            this.layerChanges1.setAttribute("opacity", "0.5");
                        }
                        else {
                            this.layerChanges1.setAttribute("opacity", "0");
                        }

                        var newBackgroundColor = STANDARD_BCOLOR;
                        if (this.compareWithReference(this.getValue(), this.getPlantValue(), this.getReferenceValue())) {
                            this.layerChanges2.setAttribute("opacity", "0");
                        }
                        else {
                            this.layerChanges2.setAttribute("fill", PLANT_OR_REF_CHANGED_COLOR);
                            this.layerChanges2.setAttribute("opacity", "0.5");
                        }

                        var titleString = this.toString();
                        this.svg.setAttribute("title", titleString);
                        this.title = titleString;
                    }

                    refresh() {
                        this.checkValues();
                    }
                }

                document.registerElement("htk-switch", {
                    prototype: HtkSwitch.prototype
                });
            })();
        </script>

    </body>
</html>
