<html>
    <head>
        <link rel="import" href="libraries.html">
        <link rel="import" href="htk-abstract-input.html">
        <link rel="import" href="htk-library-editor.html">
    </head>
    <body>
        <script>
            class HtkLibrary extends HtkAbstractInput {
                constructor() {
                    super();
                }

                attachLibraryHandler () {
                    this.availableLibraries = [];
                    //Create an editor
                    this.libraryEditor = this.shadowRoot.querySelector("#tlibrary-editor");
                    this.libraryType = undefined;
                    this.libraryMappings = undefined;
                }

                setVariable (variable) {
                    super.setVariable(variable);
                    if ("library" in variable) {
                        this.setLibraryType(variable.library.type);
                        this.setLibraryMappings(variable.library.mappings);
                    }
                }

                setLibraryType(libraryType) {
                    //Attach a selector
                    this.libraryType = libraryType;
                    this.libraryEditor.setOwnerComponent(this);
                }

                showLibraryEditor () {
                    var libraryValueUser = this.getValue().split("/");
                    var libraryUser = libraryValueUser[0];
                    var libraryName = libraryValueUser[1];
                    this.libraryEditor.showEditor(libraryUser, libraryName);
                }
            
                setReadOnly (isReadOnly) {
                    super.setReadOnly(isReadOnly);
                    this.libraryEditor.setReadOnly(isReadOnly);
                }

                setUserAllowedToWrite (isUserAllowedToWrite) {
                    super.setUserAllowedToWrite(isUserAllowedToWrite);
                    this.libraryEditor.setUserAllowedToWrite(isUserAllowedToWrite);
                }
                
                setReference (referenceToSet) {
                    super.setReference(referenceToSet);
                    this.libraryEditor.setReference(referenceToSet);
                }

                getLibraryType() {
                    return this.libraryType;
                }

                setLibraryMappings (libraryMappings) {
                    this.libraryMappings = libraryMappings;
                }

                getLibraryMappings() {
                    return this.libraryMappings;
                }

                libraryChanged (libraryOwner, newLibraryName) {
                }
            }
        </script>
    </body>
</html>
